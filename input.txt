import pandas as pd
from openpyxl import load_workbook

# Load the Excel file using openpyxl
excel_file = "example.xlsx"  # Replace with your actual file
wb = load_workbook(excel_file)
sheet = wb.active  # Get the first sheet

# Extract data while preserving merged cell values
data = []
for row in sheet.iter_rows(values_only=True):
    data.append(list(row))

# Convert to Pandas DataFrame
df = pd.DataFrame(data)

# Convert DataFrame to Markdown
markdown_text = df.to_markdown(index=False)

# Save as a Markdown file
markdown_file = "converted.md"
with open(markdown_file, "w", encoding="utf-8") as f:
    f.write(markdown_text)

# Display the Markdown text
print("Excel file with merged cells successfully converted to Markdown!")
print(markdown_text)
